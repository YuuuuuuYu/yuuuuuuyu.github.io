---
title: 4D4cat) ì´ ì–´ë…¸í…Œì´ì…˜ì€ ì™œ ì“°ëŠ”ê±¸ê¹Œ?
author: nakji
date: 2025-01-23 13:33:00 +0900
tags: [Side, Project, Annotation]
showToc: true
TocOpen: true
comments: true
disableHLJS: false
disableShare: false
hideSummary: false
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
ShowWordCount: true
UseHugoToc: true
---
ğŸ”” **ì–´ë…¸í…Œì´ì…˜ ì¢…ë¥˜ì™€ ìš©ë„**   

## **RequiredArgsConstructor**
`Lombok` ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ, í´ë˜ìŠ¤ ë‚´ì˜ `final` í•„ë“œë‚˜ `@NonNull` ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í•„ë“œë“¤ì„ ì´ˆê¸°í™”í•˜ëŠ” ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤€ë‹¤. ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì½”ë“œë¥¼ ì¤„ì—¬ì¤€ë‹¤ëŠ” ê²ƒì— ì´ì ì´ ìˆë‹¤.

```
@Service
@RequiredArgsConstructor
public class UserService {
    private final UserRepository userRepository;
    private final EmailService emailService;

    // Lombokì´ ì•„ë˜ì™€ ê°™ì€ ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤ë‹ˆë‹¤.
    // public UserService(UserRepository userRepository, EmailService emailService) {
    //     this.userRepository = userRepository;
    //     this.emailService = emailService;
    // }

    // ì„œë¹„ìŠ¤ ë¡œì§...
}
```

### **Autowiredì™€ ì°¨ì´ì **
ì‹¤ì œë¡œ ê¸°ëŠ¥ì€ ë™ì¼í•˜ì§€ë§Œ, ì½”ë“œëŸ‰ì˜ ì°¨ì´ê°€ ìˆë‹¤.

1. ìƒì„±ì ì£¼ì…  
private finalë¡œ ì„ ì–¸ì„ í–ˆë”ë¼ë„ ìƒì„±ìë¥¼ ë§Œë“¤ê³  `@Autowired`ë¥¼ ì„¤ì •í•´ì£¼ê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ì½”ë“œ ì¦ê°€

2. í•„ë“œ ì£¼ì…    
í•„ë“œ ì£¼ì…ì„ í•˜ê²Œ ë˜ë©´ finalë¡œ ì„ ì–¸ì´ ë¶ˆê°€í•˜ì—¬ ì˜ì¡´ì„±ì´ ë³€ê²½ë  ìˆ˜ë„ ìˆë‹¤.

## **Transactional**
`Spring` í”„ë ˆì„ì›Œí¬ì—ì„œ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ, ë©”ì„œë“œ ë˜ëŠ” í´ë˜ìŠ¤ ìˆ˜ì¤€ì—ì„œ íŠ¸ëœì­ì…˜ì˜ ê²½ê³„ë¥¼ ì •ì˜í•œë‹¤.
- **ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥**    
ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì—¬ ì›ìì„±ì„ ìœ ì§€

- **ë¡¤ë°± ê´€ë¦¬**     
ì˜ˆì™¸ ë°œìƒ ì‹œ ìë™ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ì—¬ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€

- **íŠ¸ëœì­ì…˜ ì „íŒŒ**     
ë©”ì„œë“œ í˜¸ì¶œ ê°„ íŠ¸ëœì­ì…˜ì˜ ì „íŒŒ ë°©ì‹ì„ ì„¤ì • ê°€ëŠ¥

### **ì£¼ìš” ì†ì„±**
- `propagation`: íŠ¸ëœì­ì…˜ ì „íŒŒ ë°©ì‹ì„ ì •ì˜
    - `REQUIRED(Default)`   
    : í˜„ì¬ íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•˜ë©´ í•´ë‹¹ íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ê³  ì—†ìœ¼ë©´ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì„ ì‹œì‘, ì¼ê´€ì„± ìˆëŠ” íŠ¸ëœì­ì…˜ ê´€ë¦¬ê°€ í•„ìš”í•  ë•Œ ì í•©

    - `REQUIRES_NEW`    
    : í˜„ì¬ íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•˜ë©´ ì¼ì‹œ ì¤‘ë‹¨í•˜ê³  ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì„ ì‹œì‘, ê¸°ì¡´ íŠ¸ëœì­ì…˜ê³¼ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•´ì•¼ í•˜ëŠ” ì‘ì—…(Log, Audit ë“±)

    - `SUPPORTS`    
    : í˜„ì¬ íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•˜ë©´ í•´ë‹¹ íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ê³ , ì—†ìœ¼ë©´ íŠ¸ëœì­ì…˜ ì—†ì´ ì‹¤í–‰, íŠ¸ëœì­ì…˜ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ” ì½ê¸° ì‘ì—…

    - `MANDATORY`   
    : ë°˜ë“œì‹œ ê¸°ì¡´ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼ í•œë‹¤. íŠ¸ëœì­ì…˜ì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ ë°œìƒ, ë°˜ë“œì‹œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ì¤‘ìš” ì‘ì—…

- `isolation`: íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ì„¤ì •
    - `READ_COMMITTED`: ì»¤ë°‹ëœ ë°ì´í„°ë§Œ ì½ì„ ìˆ˜ ìˆë‹¤. ë”í‹° ë¦¬ë“œë¥¼ ë°©ì§€
    - `SERIALIZABLE`: ê°€ì¥ ë†’ì€ ê²©ë¦¬ ìˆ˜ì¤€. íŠ¸ëœì­ì…˜ì´ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë™ì‘í•˜ì—¬ ëª¨ë“  ë™ì‹œì„± ë¬¸ì œë¥¼ ë°©ì§€

- `timeout`: íŠ¸ëœì­ì…˜ì´ íƒ€ì„ì•„ì›ƒë˜ê¸°ê¹Œì§€ì˜ ì‹œê°„ì„ ì„¤ì •. ì„¤ì •ëœ ì‹œê°„ì´ ì´ˆê³¼ë˜ë©´ íŠ¸ëœì­ì…˜ì´ ë¡¤ë°±

- `readOnly`: íŠ¸ëœì­ì…˜ì´ ì½ê¸° ì „ìš©ì¸ì§€ ì„¤ì •

### **ì¼ë°˜ ì‚¬ë¡€**
- **ê¸°ë³¸ íŠ¸ëœì­ì…˜**: @Transactionalë§Œ ì‚¬ìš©í•˜ê±°ë‚˜ propagationê³¼ isolationì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
- **ì½ê¸° ì „ìš© ì‘ì—…**: @Transactional(readOnly = true)
- **ë…ë¦½ì ì¸ íŠ¸ëœì­ì…˜ í•„ìš” ì‹œ**: @Transactional(propagation = Propagation.REQUIRES_NEW)
- **íŠ¸ëœì­ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •**: @Transactional(timeout = 30)

```
@Service
public class OrderService {

    private final OrderRepository orderRepository;
    private final PaymentService paymentService;

    // ìƒì„±ì ì£¼ì… (ì˜ˆì œ ê°„ê²°í™”ë¥¼ ìœ„í•´ ìƒëµ)

    @Transactional(
        propagation = Propagation.REQUIRED,
        isolation = Isolation.READ_COMMITTED,
        timeout = 60,
        readOnly = false,
        rollbackFor = { PaymentException.class, OrderException.class },
        noRollbackFor = { ValidationException.class }
    )
    public void placeOrder(Order order) throws PaymentException, OrderException, ValidationException {
        orderRepository.save(order);
        paymentService.processPayment(order.getPaymentDetails());
        // ...
    }
}
```

## **MappedSuperclass**
`JPA`ì—ì„œ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ, ê³µí†µ ë§¤í•‘ ì •ë³´ë¥¼ ìƒì†ë°›ê¸° ìœ„í•œ ìŠˆí¼í´ë˜ìŠ¤ë¥¼ ì •ì˜í•  ë•Œ ì‚¬ìš©í•œë‹¤. `@Entity`ë¡œ ì„ ì–¸ë˜ì§€ ì•Šì€ í´ë˜ìŠ¤ì— ì ìš©ë˜ë©°, ì´ë¥¼ ìƒì†ë°›ëŠ” ì—”í‹°í‹° í´ë˜ìŠ¤ë“¤ì´ ìƒì†ë°›ì€ í•„ë“œë“¤ì„ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.

`@MappedSuperclass`ë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ëŠ” @Entityê°€ ì•„ë‹ˆë¯€ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ì§ì ‘ ë§¤í•‘ë˜ì§€ ì•Šì§€ë§Œ ìƒì†ë°›ëŠ” `@Entity` í´ë˜ìŠ¤ë“¤ì€ @MappedSuperclassì˜ `í•„ë“œ`ë¥¼ ë§¤í•‘í•©ë‹ˆë‹¤.

### **Abstract Class?**
ê³µí†µ í•„ë“œë¥¼ ì •ì˜í•˜ëŠ” ì—­í• ë§Œ í•˜ë¯€ë¡œ, ì§ì ‘ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  í•„ìš”ê°€ ì—†ë‹¤. ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì •ì˜í•˜ë©´ì„œ ì„¤ê³„ì˜ ëª…í™•ì„±ê³¼ ì¸ìŠ¤í„´ìŠ¤í™” ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

### **EntityListeners**
ì—”í‹°í‹°ì˜ ë¼ì´í”„ì‚¬ì´í´ ì´ë²¤íŠ¸(ì˜ˆ: @PrePersist, @PostLoad ë“±)ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë¦¬ìŠ¤ë„ˆ í´ë˜ìŠ¤ë¥¼ ì§€ì •í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì—”í‹°í‹°ê°€ ìƒì„±, ì—…ë°ì´íŠ¸, ì‚­ì œë  ë•Œ íŠ¹ì • ë¡œì§ì„ ìë™ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ê°ì‚¬(Audit) ê¸°ëŠ¥ (ìƒì„± ì‹œê°„, ìˆ˜ì • ì‹œê°„, ìƒì„±ì, ìˆ˜ì •ì ë“±)ì˜ í•„ë“œë¥¼ ìë™ìœ¼ë¡œ ê´€ë¦¬í•  ë•Œ ìœ ìš©

```
public class AuditListener {

    @PrePersist
    public void prePersist(Object target) {
        if (target instanceof BaseEntity) {
            BaseEntity entity = (BaseEntity) target;
            entity.setCreatedAt(LocalDateTime.now());
            entity.setUpdatedAt(LocalDateTime.now());
        }
    }

    @PreUpdate
    public void preUpdate(Object target) {
        if (target instanceof BaseEntity) {
            BaseEntity entity = (BaseEntity) target;
            entity.setUpdatedAt(LocalDateTime.now());
        }
    }
}

@MappedSuperclass
@EntityListeners(AuditListener.class)
public abstract class BaseEntity {

    // í•„ë“œ ì •ì˜
    private Long id;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;

    // getters and setters
}

@Entity
@Table(name = "products")
public class Product extends BaseEntity {
    private String name;
    private Double price;

    // getters and setters
}
```

## **ìë£Œ ì¶œì²˜**
ChatGPT